"use strict";require("core-js/modules/es.promise"),require("core-js/modules/es.regexp.to-string"),require("core-js/modules/es.string.replace"),require("core-js/modules/web.dom-collections.iterator"),require("core-js/modules/web.url"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.Dsn=exports.log=exports.init=void 0;const defaultUrl="https://stage-api.workerlog.dev/log",usernameRegEx=/^[0-9A-Fa-f]{40}$/,projectRegEx=/^[0-9A-Fa-f]{7}$/,hostnane="workerlog.dev",headers={"User-Agent":"Workerlog/1.0 (https://workerlog.dev)","Content-Type":"application/json"// global variable to keep track of fetch event
};let _event,_dsn,_url;const init=function(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:defaultUrl;if(!a||"fetch"!==a.type)throw"workerlog: fetch event is required";_dsn=new Dsn(b),_url=new URL(c),_event=a};exports.init=init;const log=function(){if(!_event||"fetch"!=_event.type)throw"workerlog: fetch event is required. please setup fetch event using init()";_event.waitUntil(sendlog(...arguments))};exports.log=log;const sendlog=function(){const a=[];for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];for(const b of c)switch(console.log(typeof b),typeof b){case"string":a.push({t:"string",v:b});break;case"number":a.push({t:"number",v:b});break;case"boolean":a.push({t:"boolean",v:b});break;case"object":a.push({t:"object",v:b});break;case"array":a.push({t:"string",v:b});break;default:a.push({t:"other",v:b});}const e=JSON.stringify({dsn:_dsn.toString(),ts:new Date().toISOString(),msg:a});return fetch(_url.toString(),{method:"POST",headers,body:e})},Dsn=class{constructor(a){const b=new URL(a);if(this._username=b.username,this._hostname=b.hostname,this._project=b.pathname.replace(/^\//,""),!this.isValid())throw"invalid dsn"}toString(){return"https://".concat(this._username,"@").concat(this._hostname,"/").concat(this._project)}isValid(){return usernameRegEx.test(this._username)&&projectRegEx.test(this._project)&&hostnane===this._hostname}};exports.Dsn=Dsn;